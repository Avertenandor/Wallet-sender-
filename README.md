# WalletSender (Рабочая копия)

Актуальная минимизированная рабочая директория приложения для анализа токенов и массовой рассылки вознаграждений в сети BSC.

## Основной скрипт

- `WalletSender.py` — текущая активная версия приложения (GUI PyQt5 / Web3)

## Ключевые директории

- `backup_store/` — все резервные копии и исторические версии (`backup_versions`, `backup_before_mass_fix`, индивидуальные *WalletSender_backup_*.py)
- `архив/` — вспомогательные утилиты, скрипты фиксов, отчёты по исправлениям, отложенные инструменты (не участвуют в рантайме)
- `отчеты/` — итоговые и актуальные пользовательские / дев-отчёты (FIX, README_MassDistribution и т.д.)
- `ds_components/` — (если присутствуют) модули Дополнительных Сервисов (ДС) / загружаемый функционал
- `rewards_configs/` — конфигурации наград (JSON / др. файлы), автосоздаётся
- `logs/` — журналы работы приложения
- `__pycache__/` — кэш python (игнорируется)

## Базы данных

- `walletsender.db` и `wallet_sender.db` — рабочие/исторические БД. План: унифицировать и оставить одну (рекомендация: `walletsender.db`).
- `history.sqlite` — история наград / операций (если используется отдельным модулем)

## Конфигурация

- `config.json` — ключевые настройки (API ключи BscScan и др.)
- `config.key` — (если используется) ключ шифрования или служебный маркер
- `.editorconfig`, `.flake8`, `pylintrc`, `pyproject.toml`, `pyrightconfig.json`, `mypy.ini` — инструменты качества

## ABI

В код добавлен минимальный `ERC20_ABI` (balanceOf, decimals, symbol, name, transfer, approve, allowance, totalSupply, события). При необходимости расширяйте (например, для custom методов токенов).

## Массовая рассылка

Функционал расположен в классе `MainWindow` (`_tab_mass_distribution` и связанные методы `_mass_*`). Потоки запускаются через `threading.Thread`. Важные состояния:

- `self.mass_distribution_active`
- `self.mass_distribution_paused`
- `self.mass_distribution_thread`

Рекомендации улучшения:

1. Добавить завершение потока через событие (`threading.Event`) вместо флагов.
2. Лимитировать скорость / газ адаптивно.
3. Логировать результаты транзакций в отдельную таблицу БД.

## Дополнительные сервисы (ДС)

Fallback интерфейс реализован (`_create_ds_fallback`). Расширяемая зона: загрузка динамических компонентов из `ds_components/` с безопасной проверкой.

## Стратегия резервного копирования

1. Все создаваемые новые версии сохранять в `backup_store/backup_versions/` с временной меткой ISO (замена `:` на `-`).
2. При крупных изменениях: копировать текущий `WalletSender.py` перед правкой.
3. Периодически архивировать `backup_store` (zip) и выгружать вне репозитория.

## Что ещё можно сделать

- Объединить БД (миграция схемы, удаление дубля)
- Добавить unit-тесты логики разбора Excel / буфера обмена
- Вынести массовую рассылку в модуль `mass_distribution.py`
- Ввести слой абстракции для работы с Web3 (адаптер с ретраями + metrics)

## Быстрый запуск (Windows PowerShell)

```powershell
cd "C:\Users\konfu\Desktop\Sites\Experiment\Experiment1\WalletSender_MCP  копия"
python WalletSender.py
```

## Зависимости (основные)

- PyQt5 / PyQt6 (проверить используемую)
- web3
- openpyxl (для импорта Excel, опционально)
- qdarkstyle (тема интерфейса)

(См. `pyproject.toml` или `requirements` раздел.)

## Очистка / поддержка

- Старые отчёты → `отчеты/`
- Вспомогательные скрипты → `архив/`
- Новые фиксы: документировать кратко в файле `отчеты/FIXES_APPLIED.txt`

## Безопасность

- Не коммитить приватные ключи / сиды.
- Проверить права на файл `config.key`.

## Лицензия / Авторство

(Добавьте при необходимости.)

---
Этот README создан автоматически для текущего упорядоченного состояния. Обновляйте при любых структурных изменениях.
